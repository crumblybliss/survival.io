<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, orderBy, query, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCrdPP5q_eZ4OqqcCW1nguD89f5VHLPVU0",
        authDomain: "survival-f35e2.firebaseapp.com",
        projectId: "survival-f35e2",
        storageBucket: "survival-f35e2.appspot.com",
        messagingSenderId: "704462603548",
        appId: "1:704462603548:android:00d1a3fb89f9106a59e6d9"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    function updateUI(user) {
        if (user) {
            userInfo.innerHTML = `Logged in as: <strong>${user.email}</strong>`;
            loginSection.style.display = "none";
            logoutBtn.style.display = "block";
            reviewForm.style.display = "block";
            navMenu.style.display = "block";
            profilePic.style.display = "block";
            profilePic.src = user.photoURL || "default-profile.png";
        } else {
            userInfo.innerHTML = "";
            loginSection.style.display = "block";
            logoutBtn.style.display = "none";
            reviewForm.style.display = "none";
            navMenu.style.display = "none";
            profilePic.style.display = "none";
        }
    }

    onAuthStateChanged(auth, (user) => {
        updateUI(user);
    });

    document.getElementById("google-login-btn").addEventListener("click", async () => {
        try {
            await signInWithPopup(auth, provider);
            window.location.href = "index.html"; // Redirect to home page
        } catch (error) {
            alert(error.message);
        }
    });

    document.getElementById("email-login-btn").addEventListener("click", async () => {
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        try {
            await signInWithEmailAndPassword(auth, email, password);
            window.location.href = "index.html"; // Redirect to home page
        } catch (error) {
            alert(error.message);
        }
    });

    document.getElementById("signup-btn").addEventListener("click", async () => {
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        try {
            await createUserWithEmailAndPassword(auth, email, password);
            window.location.href = "index.html"; // Redirect to home page
        } catch (error) {
            alert(error.message);
        }
    });

    logoutBtn.addEventListener("click", async () => {
        await signOut(auth);
        window.location.href = "index.html"; // Redirect to home page after logout
    });
</script>

<style>
    #profile-pic {
        position: fixed;
        top: 10px;
        left: 10px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        display: none;
    }
</style>

<img id="profile-pic" src="default-profile.png" alt="Profile" onclick="window.location.href='profile.html'">

