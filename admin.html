<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Item Management</title>
    <style>
        /* General Styles for Admin Panel */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #0a1d37; /* Dark Navy Blue */
            color: #f1f1f1;
            padding: 0;
            margin: 0;
        }

        header {
            background-color: #1c2b47;
            padding: 10px;
            color: white;
            text-align: center;
        }

        .button {
            padding: 10px 20px;
            background-color: #00bcd4;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 16px;
        }

        .button:hover {
            background-color: #0097a7;
        }

        .promo-codes-table, .promo-codes-table th, .promo-codes-table td {
            border: 1px solid #fff;
            border-collapse: collapse;
            padding: 8px;
            text-align: left;
        }

        .promo-codes-table th {
            background-color: #1c2b47;
        }

        .promo-codes-table tr:nth-child(even) {
            background-color: #2c3e5f;
        }

        .promo-codes-form {
            background-color: #1c2b47;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        input, select {
            padding: 8px;
            margin: 5px;
            border-radius: 4px;
            border: 1px solid #fff;
            background-color: #2c3e5f;
            color: white;
        }

        input[type="submit"] {
            background-color: #00bcd4;
        }

        input[type="submit"]:hover {
            background-color: #0097a7;
        }
    </style>
</head>
<body>
    <header>
        <h1>Admin - Item Management</h1>
    </header>

    <!-- Promo Code Management -->
    <div class="content">
        <h2>Promo Code Management</h2>

        <!-- Add/Edit Promo Code Form -->
        <div class="promo-codes-form">
            <h3>Add/Edit Promo Code</h3>
            <form id="promo-code-form">
                <input type="text" id="promo-name" placeholder="Promo Code Name" required>
                <input type="number" id="promo-discount" placeholder="Discount Percentage" required>
                <input type="date" id="promo-expiration" placeholder="Expiration Date" required>
                <input type="submit" value="Save Promo Code">
            </form>
        </div>

        <!-- Promo Code Table -->
        <table class="promo-codes-table" id="promo-codes-table">
            <thead>
                <tr>
                    <th>Promo Code</th>
                    <th>Discount (%)</th>
                    <th>Expiration</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- Promo codes will be displayed here -->
            </tbody>
        </table>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js"></script>
    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(app);

        // Get references to DOM elements
        const promoCodeForm = document.getElementById('promo-code-form');
        const promoNameInput = document.getElementById('promo-name');
        const promoDiscountInput = document.getElementById('promo-discount');
        const promoExpirationInput = document.getElementById('promo-expiration');
        const promoCodesTable = document.getElementById('promo-codes-table').getElementsByTagName('tbody')[0];

        // Load existing promo codes from Firestore
        function loadPromoCodes() {
            db.collection("promoCodes").get().then(snapshot => {
                promoCodesTable.innerHTML = ''; // Clear existing table
                snapshot.forEach(doc => {
                    const promoCode = doc.data();
                    const row = promoCodesTable.insertRow();
                    row.innerHTML = `
                        <td>${promoCode.name}</td>
                        <td>${promoCode.discount}</td>
                        <td>${promoCode.expiration.toDate().toLocaleDateString()}</td>
                        <td>
                            <button onclick="editPromoCode('${doc.id}')">Edit</button>
                            <button onclick="deletePromoCode('${doc.id}')">Delete</button>
                        </td>
                    `;
                });
            });
        }

        // Add or Edit a Promo Code
        promoCodeForm.addEventListener('submit', function(event) {
            event.preventDefault();

            const name = promoNameInput.value;
            const discount = parseFloat(promoDiscountInput.value);
            const expiration = new Date(promoExpirationInput.value);

            // Add or edit promo code in Firestore
            db.collection("promoCodes").add({
                name: name,
                discount: discount,
                expiration: expiration
            }).then(() => {
                loadPromoCodes(); // Reload promo codes
                promoNameInput.value = '';
                promoDiscountInput.value = '';
                promoExpirationInput.value = '';
            }).catch(error => {
                console.error("Error adding/editing promo code: ", error);
            });
        });

        // Edit a Promo Code
        function editPromoCode(id) {
            db.collection("promoCodes").doc(id).get().then(doc => {
                const promoCode = doc.data();
                promoNameInput.value = promoCode.name;
                promoDiscountInput.value = promoCode.discount;
                promoExpirationInput.value = promoCode.expiration.toDate().toISOString().split('T')[0];

                // Update button to save changes
                promoCodeForm.addEventListener('submit', function(event) {
                    event.preventDefault();

                    db.collection("promoCodes").doc(id).update({
                        name: promoNameInput.value,
                        discount: parseFloat(promoDiscountInput.value),
                        expiration: new Date(promoExpirationInput.value)
                    }).then(() => {
                        loadPromoCodes(); // Reload promo codes
                        promoNameInput.value = '';
                        promoDiscountInput.value = '';
                        promoExpirationInput.value = '';
                    }).catch(error => {
                        console.error("Error updating promo code: ", error);
                    });
                });
            });
        }

        // Delete a Promo Code
        function deletePromoCode(id) {
            if (confirm("Are you sure you want to delete this promo code?")) {
                db.collection("promoCodes").doc(id).delete().then(() => {
                    loadPromoCodes(); // Reload promo codes
                }).catch(error => {
                    console.error("Error deleting promo code: ", error);
                });
            }
        }

        // Initial Load of Promo Codes
        loadPromoCodes();
    </script>
</body>
</html>

