<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bracelets & Cookies — Shop</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0f1b2b;
  --panel: #111f34;
  --muted: #9aa8c2;
  --accent: #1e90ff;
  --card: #0f233f;
  --danger: #dc3545;
  --success: #28a745;
  --surface: #13233a;
}

body {
  margin: 0;
  font-family: 'Roboto', sans-serif;
  background: linear-gradient(180deg, var(--bg) 0%, var(--panel) 100%);
  color: #e6eef8;
}

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  background: rgba(18,34,58,0.95);
  border-bottom: 1px solid rgba(255,255,255,0.05);
}
header h1 { color: var(--accent); margin: 0; }
header button { background: var(--accent); border:none; color:#fff; padding:8px 14px; border-radius:8px; cursor:pointer; }

main { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
.products { display: flex; flex-wrap: wrap; gap:20px; }
.product-card {
  background: var(--card); border-radius:12px; padding:16px; width: 220px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.35); display:flex; flex-direction:column; justify-content:space-between;
}
.product-card h3 { margin:0 0 8px; color: var(--accent);}
.product-card p { margin:0 0 8px; color: var(--muted);}
.product-card button { margin-top:auto; }

#cartPanel {
  position: fixed; right:0; top:0; width:320px; height:100%; background:var(--panel);
  border-left:1px solid rgba(255,255,255,0.05); padding:16px; display:flex; flex-direction:column;
  transform: translateX(100%); transition: transform .3s; z-index:999;
}
#cartPanel.show { transform: translateX(0); }
#cartItems { flex:1; overflow:auto; margin-top:10px; }
.cart-item { display:flex; justify-content: space-between; align-items:center; margin-bottom:10px; }
.cart-item span { flex:1; }
.cart-item button { background: var(--danger); border:none; color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer; }

#checkoutBtn { background: var(--success); border:none; padding:10px 16px; border-radius:8px; cursor:pointer; margin-top:10px; }

#openCartBtn {
  position: fixed; right:20px; bottom:20px; padding:12px 18px; border-radius:50px;
  background: var(--accent); border:none; color:#fff; cursor:pointer; z-index:1000;
}
</style>
</head>
<body>
<header>
  <h1>Bracelets & Cookies</h1>
  <button id="openCartBtn">Cart (0)</button>
</header>

<main>
  <div class="products" id="productsContainer">
    <!-- Products will be loaded here -->
  </div>
</main>

<div id="cartPanel">
  <h2>Shopping Cart</h2>
  <div id="cartItems"></div>
  <div><strong>Total: $<span id="cartTotal">0</span></strong></div>
  <button id="checkoutBtn">Checkout</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey:"AIzaSyCrdPP5q_eZ4OqqcCW1nguD89f5VHLPVU0",
  authDomain:"survival-f35e2.firebaseapp.com",
  projectId:"survival-f35e2",
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const productsContainer = document.getElementById("productsContainer");
const cartPanel = document.getElementById("cartPanel");
const cartItemsDiv = document.getElementById("cartItems");
const openCartBtn = document.getElementById("openCartBtn");
const cartTotalSpan = document.getElementById("cartTotal");

let cart = [];

openCartBtn.addEventListener("click", ()=>cartPanel.classList.toggle("show"));

function updateCartUI(){
  cartItemsDiv.innerHTML="";
  let total=0;
  cart.forEach((item,i)=>{
    const div = document.createElement("div");
    div.className="cart-item";
    div.innerHTML = `<span>${item.name} x ${item.qty} - $${item.price*item.qty}</span>`;
    const rmBtn = document.createElement("button");
    rmBtn.textContent="Remove";
    rmBtn.onclick=()=>{ cart.splice(i,1); updateCartUI(); };
    div.appendChild(rmBtn);
    cartItemsDiv.appendChild(div);
    total += item.price*item.qty;
  });
  cartTotalSpan.textContent=total.toFixed(2);
  openCartBtn.textContent = `Cart (${cart.reduce((a,b)=>a+b.qty,0)})`;
}

// Load products from Firestore
async function loadProducts(){
  const snapshot = await getDocs(collection(db,"products"));
  snapshot.forEach(docSnap=>{
    const p = docSnap.data();
    const card = document.createElement("div");
    card.className="product-card";
    card.innerHTML = `
      <h3>${p.name}</h3>
      <p>Price: $${p.price}</p>
      <p>Colors: ${p.colors?.join(", ") || "—"}</p>
      <p>Sizes: ${p.sizes?.join(", ") || "—"}</p>
    `;
    const btn = document.createElement("button");
    btn.textContent="Add to Cart";
    btn.onclick=()=>{
      const existing = cart.find(c=>c.id===docSnap.id);
      if(existing){ existing.qty+=1; }
      else { cart.push({...p,id:docSnap.id,qty:1}); }
      updateCartUI();
    };
    card.appendChild(btn);
    productsContainer.appendChild(card);
  });
}

loadProducts();
</script>
</body>
</html>
